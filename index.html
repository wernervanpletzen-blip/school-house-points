<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Leeuwenhof Huispunte</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- PWA manifest -->
    <link rel="manifest" href="manifest.json" />

    <!-- Theme color -->
    <meta name="theme-color" content="#064420" />

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css" />

    <!-- Firebase (compat version) -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  </head>

  <body>
    <div class="app-shell">

      <!-- ================= PREMIUM HEADER ================= -->
      <header class="app-header">
        <div class="header-left">
          <img src="school-logo.png" alt="School logo" class="header-logo" />
          <div class="app-header-title">Leeuwenhof Huispunte</div>
        </div>
        <div class="header-right" id="headerUserInfo"></div>
      </header>

      <main class="app-main">

        <!-- ================= AUTH SECTION ================= -->
        <section class="card" id="authSection">
          <div class="school-logo-wrapper">
            <img src="school-logo.png" alt="School logo" class="school-logo" />
          </div>

          <h2 class="card-title">Welkom</h2>
          <p class="card-subtitle">
            Meld aan of registreer as 'n leerder of onderwyser.
          </p>

          <div class="auth-tabs">
            <button class="btn btn-ghost" id="showLogin">Log in</button>
            <button class="btn btn-ghost" id="showLearnerRegister">Leerder Registrasie</button>
            <button class="btn btn-ghost" id="showTeacherRegister">Onderwyser Registrasie</button>
          </div>

          <!-- Login form -->
          <form class="form-grid mt-2" id="loginForm">
            <div>
              <div class="label">E-pos</div>
              <input class="input" type="email" id="loginEmail" required />
            </div>
            <div>
              <div class="label">Wagwoord</div>
              <input class="input" type="password" id="loginPassword" required />
            </div>
            <div id="loginError" class="error mt-1"></div>
            <button class="btn btn-primary mt-2" type="submit">Log in</button>
          </form>

          <!-- Learner registration -->
          <form class="form-grid mt-2 hidden" id="learnerRegisterForm">
            <div class="flex">
              <div>
                <div class="label">Naam</div>
                <input class="input" id="learnerName" required />
              </div>
              <div>
                <div class="label">Van</div>
                <input class="input" id="learnerSurname" required />
              </div>
            </div>

            <div class="flex">
              <div>
                <div class="label">Graad</div>
                <input class="input" id="learnerGrade" type="number" required />
              </div>
              <div>
                <div class="label">Selfoon (opsioneel)</div>
                <input class="input" id="learnerPhone" />
              </div>
            </div>

            <div>
              <div class="label">Huis</div>
              <select class="select" id="learnerHouse">
                <option value="houseA">Eerhof</option>
                <option value="houseB">Edelhof</option>
              </select>
            </div>

            <div class="flex">
              <div>
                <div class="label">E-pos</div>
                <input class="input" id="learnerEmail" type="email" required />
              </div>
              <div>
                <div class="label">Wagwoord</div>
                <input class="input" id="learnerPassword" type="password" required />
              </div>
            </div>

            <div id="learnerRegisterError" class="error mt-1"></div>
            <button class="btn btn-primary mt-2" type="submit">Registreer Leerder</button>
          </form>

          <!-- Teacher registration -->
          <form class="form-grid mt-2 hidden" id="teacherRegisterForm">
            <div class="flex">
              <div>
                <div class="label">Naam</div>
                <input class="input" id="teacherName" required />
              </div>
              <div>
                <div class="label">Van</div>
                <input class="input" id="teacherSurname" required />
              </div>
            </div>

            <div>
              <div class="label">E-pos</div>
              <input class="input" id="teacherEmail" type="email" required />
            </div>

            <div>
              <div class="label">Wagwoord</div>
              <input class="input" id="teacherPassword" type="password" required />
            </div>

            <div id="teacherRegisterError" class="error mt-1"></div>
            <button class="btn btn-primary mt-2" type="submit">Registreer Onderwyser</button>
          </form>
        </section>

        <!-- ================= LEARNER DASHBOARD ================= -->
        <section class="card hidden" id="learnerDashboard">
          <h2 class="card-title">Leerder Paneelbord</h2>
          <div class="card-subtitle" id="learnerInfo"></div>

          <h3 class="mt-2">Aktiewe Gebeure</h3>
          <p class="card-subtitle">Gaan na jou onderwyser vir teenwoordigheidskontrole.</p>

          <table class="table" id="learnerEventsTable">
            <thead>
              <tr>
                <th>Gebeurtenis</th>
                <th>Datum</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </section>

        <!-- ================= TEACHER DASHBOARD ================= -->
        <section class="card hidden" id="teacherDashboard">
          <h2 class="card-title">Onderwyser Paneelbord</h2>
          <p class="card-subtitle">Bestuur gebeure en teenwoordigheid.</p>

          <div class="flex mt-1">
            <button class="btn btn-ghost" id="tabEvents">Gebeure</button>
            <button class="btn btn-ghost" id="tabCheckIn">Teenwoordigheid</button>
            <button class="btn btn-ghost hidden" id="tabPoints">Huispunte</button>
            <button class="btn btn-ghost" id="logoutButton">Log uit</button>
          </div>

          <!-- Events Panel -->
          <div class="mt-2" id="teacherEventsPanel">
            <h3>Skep Gebeurtenis</h3>
            <form class="form-grid mt-1" id="createEventForm">
              <div class="flex">
                <div>
                  <div class="label">Naam</div>
                  <input class="input" id="eventName" required />
                </div>
                <div>
                  <div class="label">Datum</div>
                  <input class="input" id="eventDate" type="date" required />
                </div>
              </div>
              <button class="btn btn-primary mt-1" type="submit">Voeg By</button>
            </form>

            <h3 class="mt-2">Alle Gebeure</h3>
            <table class="table" id="teacherEventsTable">
              <thead>
                <tr>
                  <th>Gebeurtenis</th>
                  <th>Datum</th>
                  <th>Status</th>
                  <th>Aksies</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

          <!-- Check-In Panel -->
          <div class="mt-2 hidden" id="teacherCheckInPanel">
            <h3>Merk Teenwoordigheid</h3>

            <div class="flex mt-1">
              <div>
                <div class="label">Gebeurtenis</div>
                <select class="select" id="checkInEventSelect"></select>
              </div>

              <div>
                <div class="label">Graad</div>
                <input class="input" id="filterGrade" placeholder="Graad" />
              </div>

              <div>
                <div class="label">Huis</div>
                <select class="select" id="filterHouse">
                  <option value="">Almal</option>
                  <option value="houseA">Eerhof</option>
                  <option value="houseB">Edelhof</option>
                </select>
              </div>
            </div>

            <table class="table" id="checkInLearnersTable">
              <thead>
                <tr>
                  <th>Leerder</th>
                  <th>Graad</th>
                  <th>Huis</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

          <!-- House Points Panel (ADMIN ONLY) -->
          <div class="mt-2 hidden" id="teacherPointsPanel">
            <h3>Huispunte (Net Admin)</h3>
            <p class="card-subtitle">Slegs die Admin kan hierdie sien.</p>

            <div class="house-points">
              <div class="house-card">
                <div class="house-card-header">
                  <img src="house-a-logo.png" class="house-logo" />
                  <h4>Eerhof</h4>
                </div>
                <div class="points" id="houseAPoints">0</div>
              </div>

              <div class="house-card">
                <div class="house-card-header">
                  <img src="house-b-logo.png" class="house-logo" />
                  <h4>Edelhof</h4>
                </div>
                <div class="points" id="houseBPoints">0</div>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>

    <!-- PWA Service Worker -->
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker.register("pwabuilder-sw.js");
        });
      }
    </script>

    <!-- Main app logic -->
    <script src="app.js"></script>
  </body>
</html>
